city <- "Amsterdam"
country <- "NL"
#geocoding
geocode_base <- 'http://api.openweathermap.org/geo/1.0/direct?q='
geocode_limit <- '&limit=1&appid='
geocode_appid <- '03782ca206139ca19d564d33c2813127'
geocode_url <- paste0(
geocode_base,
city,
",",
country,
geocode_limit,
geocode_appid
)
geocode_raw <- GET(geocode_url)
geocode_char <- rawToChar(geocode_raw$content)
geocode_dat <- fromJSON(geocode_char)
lat_number <- geocode_dat[1,3]
lon_number <- geocode_dat[1,4]
library(httr)
library(jsonlite)
library(ggplot2)
library(dplyr)
library(lubridate)
city <- "Amsterdam"
country <- "NL"
#geocoding
geocode_base <- 'http://api.openweathermap.org/geo/1.0/direct?q='
geocode_limit <- '&limit=1&appid='
geocode_appid <- '03782ca206139ca19d564d33c2813127'
geocode_url <- paste0(
geocode_base,
city,
",",
country,
geocode_limit,
geocode_appid
)
geocode_raw <- GET(geocode_url)
geocode_char <- rawToChar(geocode_raw$content)
geocode_dat <- fromJSON(geocode_char)
lat_number <- geocode_dat[1,3]
lon_number <- geocode_dat[1,4]
current_time <- Sys.time()
current_time_unix <- as.numeric(as.POSIXct(current_time))
two_weeks_back <- Sys.time() - weeks(2)
two_weeks_back_unix <- as.numeric(as.POSIXct(two_weeks_back))
hist_aq_url_1 <- "http://api.openweathermap.org/data/2.5/air_pollution/history?lat="
lat_number
hist_aq_url_2 <- "&lon="
lon_number
hist_aq_url_3 <- "&start="
current_time_unix
hist_aq_url_4 <- "&end="
two_weeks_back_unix
hist_aq_url_5 <- "&appid="
appid <- '&appid=03782ca206139ca19d564d33c2813127'
hist_aq_url <- paste0(hist_aq_url_1,
lat_number,
hist_aq_url_2,
lon_number,
hist_aq_url_3,
current_time_unix,
hist_aq_url_4,
two_weeks_back_unix,
hist_aq_url_5,
appid)
hist_aq_raw <- GET(hist_aq_url)
hist_aq_char <- rawToChar(hist_aq_raw$content)
hist_aq_dat <- fromJSON(hist_aq_char)
View(hist_aq_dat)
city <- "Amsterdam"
country <- "NL"
#geocoding
geocode_base <- 'http://api.openweathermap.org/geo/1.0/direct?q='
geocode_limit <- '&limit=1&appid='
geocode_appid <- '03782ca206139ca19d564d33c2813127'
geocode_url <- paste0(
geocode_base,
city,
",",
country,
geocode_limit,
geocode_appid
)
geocode_raw <- GET(geocode_url)
geocode_char <- rawToChar(geocode_raw$content)
geocode_dat <- fromJSON(geocode_char)
lat_number <- geocode_dat[1,3]
lon_number <- geocode_dat[1,4]
#get time stamps
current_time <- Sys.time()
current_time_unix <- as.numeric(as.POSIXct(current_time))
two_weeks_back <- Sys.time() - weeks(2)
two_weeks_back_unix <- as.numeric(as.POSIXct(two_weeks_back))
#get history aq data
hist_aq_url_1 <- "http://api.openweathermap.org/data/2.5/air_pollution/history?lat="
lat_number
hist_aq_url_2 <- "&lon="
lon_number
hist_aq_url_3 <- "&start="
current_time_unix
hist_aq_url_4 <- "&end="
two_weeks_back_unix
hist_aq_url_5 <- "&appid="
appid <- '03782ca206139ca19d564d33c2813127'
hist_aq_url <- paste0(hist_aq_url_1,
lat_number,
hist_aq_url_2,
lon_number,
hist_aq_url_3,
current_time_unix,
hist_aq_url_4,
two_weeks_back_unix,
hist_aq_url_5,
appid)
hist_aq_raw <- GET(hist_aq_url)
hist_aq_char <- rawToChar(hist_aq_raw$content)
hist_aq_dat <- fromJSON(hist_aq_char)
View(hist_aq_dat)
